name <- str_extract(pos, '\\w{2}')
name
name <- str_extract(pos, '\w{2}')
name <- str_extract(pos, '.*(?=\\s..\\()')
name <- str_extract(pos, '\\.*(?=\\s..\\()')
name <- str_extract(pos, "\\.*(?=\\s.{2}\\()"")
""
name <- str_extract(pos, "\\.*(?=\\s.{2}\\()")
name <- str_extract(pos, ".(?=\\s.{2}\\()")
name <- str_extract(pos, ".(?=\\()")
name <- str_extract(pos, perl(".*(?=\\s..\\()"))
name
name <- str_extract(pos, perl(".*(?=\\s.{1,3}\\()"))
name
1652-250
1402-650
POS
POS <- str_extract(pos, "\\(\\w{1,2}\\)")
POS
gsub('(', '', POS)
gsub('\\(', '', POS)
POS <- gsub('\\)', '', POS)
POS
POS <- gsub('\\(', '', POS)
POS
fans.bat <- read.csv('../../../Data/Fans_batters.csv')
steamer.bat <- read.csv('../../../Data//Steamer_batters.csv')
zips.bat <- read.csv('../../../Data/ZIPS_batters.csv')
fans.pit <- read.csv('../../../Data//Fans_pitchers.csv')
steamer.pit <- read.csv('../../../Data/Steamer_pitchers.csv')
zips.pit <- read.csv('../../../Data/ZIPS_pitchers.csv')
library(dplyr)
#Rename variables so I know where they come from
names(fans.bat)[1:24] <- paste('fans', names(fans.bat)[1:24], sep='_')
names(steamer.bat)[1:29] <- paste('steamer', names(steamer.bat)[1:29],
sep='_')
names(zips.bat)[1:24] <- paste('zips', names(zips.bat)[1:24], sep='_')
#join by player id
bat <- full_join(fans.bat, steamer.bat, by='playerid')
bat <- full_join(bat, zips.bat, by='playerid')
#repeat for pitching
names(fans.pit)[1:19] <- paste('fans', names(fans.pit)[1:19], sep='_')
names(steamer.pit)[1:20] <- paste('steamer', names(steamer.pit)[1:20],
sep='_')
names(zips.pit)[1:18] <- paste('zips', names(zips.pit)[1:18], sep='_')
#join by player id
pit <- full_join(fans.pit, steamer.pit, by='playerid')
pit <- full_join(pit, zips.pit, by='playerid')
##Batting stats
bat$agg.runs <- apply(bat[,c('fans_R', 'steamer_R', 'fans_R')], 1,
function(x) mean(x, na.rm=T))
bat$agg.hr <- apply(bat[,c('fans_HR', 'steamer_HR', 'fans_HR')], 1,
function(x) mean(x, na.rm=T))
bat$agg.rbi <- apply(bat[,c('fans_RBI', 'steamer_RBI', 'fans_RBI')], 1,
function(x) mean(x, na.rm=T))
bat$agg.sb <- apply(bat[,c('fans_SB', 'steamer_SB', 'fans_SB')], 1,
function(x) mean(x, na.rm=T))
bat$agg.obp <- apply(bat[,c('fans_OBP', 'steamer_OBP', 'fans_OBP')], 1,
function(x) mean(x, na.rm=T))
#Singles are a bit trickier...
bat$fans_1b <- bat$fans_H - (bat$fans_X2B + bat$fans_X3B + bat$fans_HR)
bat$steamer_1b <- bat$steamer_H - (bat$steamer_X2B + bat$steamer_X3B +
bat$steamer_HR)
bat$zips_1b <- bat$zips_H - (bat$zips_X2B + bat$zips_X3B + bat$zips_HR)
bat$agg.1b <- apply(bat[,c('fans_1b', 'steamer_1b', 'fans_1b')], 1,
function(x) mean(x, na.rm=T))
bat$agg.2b <- apply(bat[,c('fans_X2B', 'steamer_X2B', 'fans_X2B')], 1,
function(x) mean(x, na.rm=T))
bat$agg.3b <- apply(bat[,c('fans_X3B', 'steamer_X3B', 'fans_X3B')], 1,
function(x) mean(x, na.rm=T))
bat$agg.bb <- apply(bat[,c('fans_BB', 'steamer_BB', 'fans_BB')], 1,
function(x) mean(x, na.rm=T))
bat$agg.avg <- apply(bat[,c('fans_AVG', 'steamer_AVG', 'fans_AVG')], 1,
function(x) mean(x, na.rm=T))
bat$agg.obp <- apply(bat[,c('fans_OBP', 'steamer_OBP', 'fans_OBP')], 1,
function(x) mean(x, na.rm=T))
bat$agg.ops <- apply(bat[,c('fans_OPS', 'steamer_OPS', 'fans_OPS')], 1,
function(x) mean(x, na.rm=T))
##Pitching stats
pit$agg.w <- apply(pit[,c('fans_W', 'steamer_W', 'zips_W')], 1, function(x)
mean(x, na.rm=T))
#zips doesn't forecast saves
pit$agg.sv <- apply(pit[,c('fans_SV', 'steamer_SV')], 1, function(x)
mean(x, na.rm=T))
pit$agg.k <- apply(pit[,c('fans_SO', 'steamer_SO', 'zips_SO')], 1, function(x)
mean(x, na.rm=T))
pit$agg.era <- apply(pit[,c('fans_ERA', 'steamer_ERA', 'zips_ERA')], 1,
function(x) mean(x, na.rm=T))
pit$agg.whip <- apply(pit[,c('fans_WHIP', 'steamer_WHIP', 'zips_WHIP')], 1,
function(x) mean(x, na.rm=T))
##Batting stats
bat$agg.sd.runs <- apply(bat[,c('fans_R', 'steamer_R', 'fans_R')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.hr <- apply(bat[,c('fans_HR', 'steamer_HR', 'fans_HR')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.rbi <- apply(bat[,c('fans_RBI', 'steamer_RBI', 'fans_RBI')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.sb <- apply(bat[,c('fans_SB', 'steamer_SB', 'fans_SB')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.obp <- apply(bat[,c('fans_OBP', 'steamer_OBP', 'fans_OBP')], 1,
function(x) sd(x, na.rm=T))
#Singles are a bit trickier...
bat$fans_1b <- bat$fans_H - (bat$fans_X2B + bat$fans_X3B + bat$fans_HR)
bat$steamer_1b <- bat$steamer_H - (bat$steamer_X2B + bat$steamer_X3B +
bat$steamer_HR)
bat$zips_1b <- bat$zips_H - (bat$zips_X2B + bat$zips_X3B + bat$zips_HR)
bat$agg.sd.1b <- apply(bat[,c('fans_1b', 'steamer_1b', 'fans_1b')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.2b <- apply(bat[,c('fans_X2B', 'steamer_X2B', 'fans_X2B')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.3b <- apply(bat[,c('fans_X3B', 'steamer_X3B', 'fans_X3B')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.bb <- apply(bat[,c('fans_BB', 'steamer_BB', 'fans_BB')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.avg <- apply(bat[,c('fans_AVG', 'steamer_AVG', 'fans_AVG')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.obp <- apply(bat[,c('fans_OBP', 'steamer_OBP', 'fans_OBP')], 1,
function(x) sd(x, na.rm=T))
bat$agg.sd.ops <- apply(bat[,c('fans_OPS', 'steamer_OPS', 'fans_OPS')], 1,
function(x) sd(x, na.rm=T))
##Pitching stats
pit$agg.sd.w <- apply(pit[,c('fans_W', 'steamer_W', 'zips_W')], 1, function(x)
sd(x, na.rm=T))
#zips doesn't forecast saves
pit$agg.sd.sv <- apply(pit[,c('fans_SV', 'steamer_SV')], 1, function(x) sd(x, na.rm=T))
pit$agg.sd.k <- apply(pit[,c('fans_SO', 'steamer_SO', 'zips_SO')], 1, function(x)
sd(x, na.rm=T))
pit$agg.sd.era <- apply(pit[,c('fans_ERA', 'steamer_ERA', 'zips_ERA')], 1,
function(x) sd(x, na.rm=T))
pit$agg.sd.whip <- apply(pit[,c('fans_WHIP', 'steamer_WHIP', 'zips_WHIP')], 1,
function(x) sd(x, na.rm=T))
pit$fans_Name[1:5]
name[1:5]
str(name)
str(pit$fans_Name)
df.id <- data.frame(name = name,
position = as.factor(POS))
head(df.id)
levels(df.id$position)
library(car)
?recode
df.id$position <- recode(df.id$position, c('LF', 'RF', 'CF')='OF')
df.id$position <- recode(df.id$position, 'c(LF, RF, CF)=OF')
df.id$position <- recode(df.id$position, "c('LF', RF, CF)=OF")
df.id$position <- recode(df.id$position, "c('LF', 'RF', 'CF')=OF")
df.id$position <- recode(df.id$position, "c('LF', 'RF', 'CF')='OF'")
levels(df.id$position)
#Below is for fantasy fellowship
bat$agg.pa <- apply(bat[,c('fans_PA', 'steamer_PA', 'zips_PA')], 1,
function(x) mean(x, na.rm=T))
pit$agg.ip <- apply(pit[,c('fans_IP', 'steamer_IP', 'zips_IP')], 1,
function(x) mean(x, na.rm=T))
bat$agg.sd.pa <- apply(bat[,c('fans_PA', 'steamer_PA', 'zips_PA')], 1,
function(x) sd(x, na.rm=T))
pit$agg.sd.ip <- apply(pit[,c('fans_IP', 'steamer_IP', 'zips_IP')], 1,
function(x) sd(x, na.rm=T))
bat$agg.pa[bat$agg.pa == 1] <- NA
bat$pa.weight <- bat$agg.pa/mean(bat$agg.pa, na.rm=T)
pit$agg.ip[pit$agg.ip == 1] <- NA
pit$ip.weight <- pit$agg.ip/mean(pit$agg.ip, na.rm=T)
bat$agg.runs.std <- scale(bat$agg.runs)
bat$agg.hr.std <- scale(bat$agg.hr)
bat$agg.rbi.std <- scale(bat$agg.rbi)
bat$agg.sb.std <- scale(bat$agg.sb)
bat$agg.obp.std <- scale(bat$agg.obp)
bat$agg.w.obp.std <- scale(bat$agg.obp*bat$pa.weight)
bat$talent.index <- bat$agg.runs.std + bat$agg.hr.std + bat$agg.rbi.std + bat$agg.sb.std + bat$agg.w.obp.std
pit$agg.w.std <- scale(pit$agg.w)
pit$agg.sv.std <- scale(pit$agg.sv)
pit$agg.k.std <- scale(pit$agg.k)
pit$agg.era.std <- scale(pit$agg.era)*-1
pit$agg.whip.std <- scale(pit$agg.whip)*-1
pit$agg.w.era.std <- scale(pit$agg.era/pit$ip.weight)*-1
pit$agg.w.whip.std <- scale(pit$agg.whip/pit$ip.weight)*-1
pit$talent.index <- pit$agg.w.std + pit$agg.sv.std + pit$agg.k.std + pit$agg.w.era.std + pit$agg.w.whip.std
collapsed <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
)
sorted<-arrange(collapsed, desc(perf.index))
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name))),
std.k=c(pit$agg.k.std, rep(NA, length(bat$fans_Name))),
std.era=c(pit$agg.era.std, rep(NA, length(bat$fans_Name))),
std.whip=c(pit$agg.whip.std, rep(NA, length(bat$fans_Name))),
std.r=c(rep(NA, length(pit$fans_Name), bat$agg.runs.std)),
std.hr=c(rep(NA, length(pit$fans_Name), bat$agg.hr.std)),
std.rbi=c(rep(NA, length(pit$fans_Name), bat$agg.rbi.std)),
std.sb=c(rep(NA, length(pit$fans_Name), bat$agg.sb.std)),
std.obp=c(rep(NA, length(pit$fans_Name), bat$agg.obp.std)),
std.w.obp=c(rep(NA, length(pit$fans_Name), bat$agg.w.obp.std)),
w=c(pit$agg.w, rep(NA, length(bat$fans_Name))),
sv=c(pit$agg.sv, rep(NA, length(bat$fans_Name))),
k=c(pit$agg.k, rep(NA, length(bat$fans_Name))),
era=c(pit$agg.era, rep(NA, length(bat$fans_Name))),
whip=c(pit$agg.whip, rep(NA, length(bat$fans_Name))),
r=c(rep(NA, length(pit$fans_Name), bat$agg.runs)),
hr=c(rep(NA, length(pit$fans_Name), bat$agg.hr)),
rbi=c(rep(NA, length(pit$fans_Name), bat$agg.rbi)),
sb=c(rep(NA, length(pit$fans_Name), bat$agg.sb)),
obp=c(rep(NA, length(pit$fans_Name), bat$agg.obp)),
w.obp=c(rep(NA, length(pit$fans_Name), bat$agg.w.obp))
)
length(pit$fans_Name)
length(bat$fans_Name)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name)))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name)))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name))),
std.k=c(pit$agg.k.std, rep(NA, length(bat$fans_Name)))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name))),
std.k=c(pit$agg.k.std, rep(NA, length(bat$fans_Name)))
std.era=c(pit$agg.era.std, rep(NA, length(bat$fans_Name))),
std.whip=c(pit$agg.whip.std, rep(NA, length(bat$fans_Name)))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name))),
std.k=c(pit$agg.k.std, rep(NA, length(bat$fans_Name))),
std.era=c(pit$agg.era.std, rep(NA, length(bat$fans_Name))),
std.whip=c(pit$agg.whip.std, rep(NA, length(bat$fans_Name)))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name))),
std.k=c(pit$agg.k.std, rep(NA, length(bat$fans_Name))),
std.era=c(pit$agg.era.std, rep(NA, length(bat$fans_Name))),
std.whip=c(pit$agg.whip.std, rep(NA, length(bat$fans_Name))),
std.r=c(rep(NA, length(pit$fans_Name), bat$agg.runs.std)),
std.hr=c(rep(NA, length(pit$fans_Name), bat$agg.hr.std)),
std.rbi=c(rep(NA, length(pit$fans_Name), bat$agg.rbi.std))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, length(bat$fans_Name))),
std.sv=c(pit$agg.sv.std, rep(NA, length(bat$fans_Name))),
std.k=c(pit$agg.k.std, rep(NA, length(bat$fans_Name))),
std.era=c(pit$agg.era.std, rep(NA, length(bat$fans_Name))),
std.whip=c(pit$agg.whip.std, rep(NA, length(bat$fans_Name))),
std.r=c(rep(NA, length(pit$fans_Name), bat$agg.runs.std))
)
length(pit$fans_Name)
pit.length <- length(pit$fans_Name)
bat.length <- length(bat$fans_Name)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std))
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std)
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std),
std.hr=c(rep(NA, pit.length), bat$agg.hr.std),
std.rbi=c(rep(NA, pit.length), bat$agg.rbi.std)
std.sb=c(rep(NA, pit.length), bat$agg.sb.std),
std.obp=c(rep(NA, pit.length), bat$agg.obp.std),
std.w.obp=c(rep(NA, pit.length), bat$agg.w.obp.std),
w=c(pit$agg.w, rep(NA, bat.length)),
sv=c(pit$agg.sv, rep(NA, bat.length),
k=c(pit$agg.k, rep(NA, bat.length)),
era=c(pit$agg.era, rep(NA, bat.length)),
whip=c(pit$agg.whip, rep(NA, bat.length)),
r=c(rep(NA, pit.length), bat$agg.runs),
hr=c(rep(NA, pit.length), bat$agg.hr),
rbi=c(rep(NA, pit.length), bat$agg.rbi),
sb=c(rep(NA, pit.length), bat$agg.sb),
obp=c(rep(NA, pit.length), bat$agg.obp),
w.obp=c(rep(NA, pit.length), bat$agg.w.obp)
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std),
std.hr=c(rep(NA, pit.length), bat$agg.hr.std),
std.rbi=c(rep(NA, pit.length), bat$agg.rbi.std),
std.sb=c(rep(NA, pit.length), bat$agg.sb.std),
std.obp=c(rep(NA, pit.length), bat$agg.obp.std),
std.w.obp=c(rep(NA, pit.length), bat$agg.w.obp.std),
w=c(pit$agg.w, rep(NA, bat.length)),
sv=c(pit$agg.sv, rep(NA, bat.length),
k=c(pit$agg.k, rep(NA, bat.length)),
era=c(pit$agg.era, rep(NA, bat.length)),
whip=c(pit$agg.whip, rep(NA, bat.length)),
r=c(rep(NA, pit.length), bat$agg.runs),
hr=c(rep(NA, pit.length), bat$agg.hr),
rbi=c(rep(NA, pit.length), bat$agg.rbi),
sb=c(rep(NA, pit.length), bat$agg.sb),
obp=c(rep(NA, pit.length), bat$agg.obp),
w.obp=c(rep(NA, pit.length), bat$agg.w.obp)
)
)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std),
std.hr=c(rep(NA, pit.length), bat$agg.hr.std),
std.rbi=c(rep(NA, pit.length), bat$agg.rbi.std),
std.sb=c(rep(NA, pit.length), bat$agg.sb.std),
std.obp=c(rep(NA, pit.length), bat$agg.obp.std),
std.w.obp=c(rep(NA, pit.length), bat$agg.w.obp.std),
w=c(pit$agg.w, rep(NA, bat.length)),
sv=c(pit$agg.sv, rep(NA, bat.length)),
k=c(pit$agg.k, rep(NA, bat.length)),
era=c(pit$agg.era, rep(NA, bat.length)),
whip=c(pit$agg.whip, rep(NA, bat.length)),
r=c(rep(NA, pit.length), bat$agg.runs),
hr=c(rep(NA, pit.length), bat$agg.hr),
rbi=c(rep(NA, pit.length), bat$agg.rbi),
sb=c(rep(NA, pit.length), bat$agg.sb),
obp=c(rep(NA, pit.length), bat$agg.obp),
w.obp=c(rep(NA, pit.length), bat$agg.w.obp)
)
head(combined)
sorted<-arrange(combined, desc(perf.index))
head(sorted)
max(sorted$std.r)
max(sorted$std.r, na.rm=T)
max(sorted$std.hr, na.rm=T)
hist(sorted$std.sb)
df <- full_join(df.id, sorted)
head(df)
write.table(df, file='projections.csv')
write.table(df, file='projections.csv', sep = ',')
df[1:25, 1:5]
df <- full_join(df.id, combined)
df<-arrange(df, desc(perf.index))
write.table(df, file='projections.csv', sep = ',')
table(df$position)
98/(98+36)
46/(98+36)
12*.34
pit$agg.sv.std <- scale(pit$agg.sv)*.34
pit$talent.index <- pit$agg.w.std + pit$agg.sv.std + pit$agg.k.std + pit$agg.w.era.std + pit$agg.w.whip.std
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std),
std.hr=c(rep(NA, pit.length), bat$agg.hr.std),
std.rbi=c(rep(NA, pit.length), bat$agg.rbi.std),
std.sb=c(rep(NA, pit.length), bat$agg.sb.std),
std.obp=c(rep(NA, pit.length), bat$agg.obp.std),
std.w.obp=c(rep(NA, pit.length), bat$agg.w.obp.std),
w=c(pit$agg.w, rep(NA, bat.length)),
sv=c(pit$agg.sv, rep(NA, bat.length)),
k=c(pit$agg.k, rep(NA, bat.length)),
era=c(pit$agg.era, rep(NA, bat.length)),
whip=c(pit$agg.whip, rep(NA, bat.length)),
r=c(rep(NA, pit.length), bat$agg.runs),
hr=c(rep(NA, pit.length), bat$agg.hr),
rbi=c(rep(NA, pit.length), bat$agg.rbi),
sb=c(rep(NA, pit.length), bat$agg.sb),
obp=c(rep(NA, pit.length), bat$agg.obp),
w.obp=c(rep(NA, pit.length), bat$agg.w.obp)
)
df <- full_join(df.id, combined)
df<-arrange(df, desc(perf.index))
df[1:25, 1:5]
summary(df$std.sb)
bat$agg.sb.cap[which(bat$agg.sb.std > 5)]
bat$agg.sb.cap <- bat$agg.sb.std
bat$agg.sb.cap[which(bat$agg.sb.std > 5)]
bat$agg.sb.cap[which(bat$agg.sb.std > 5)] <- 5
bat$agg.sb.cap[which(bat$agg.sb.std > 6)]
bat$agg.sb.cap <- bat$agg.sb.std
bat$agg.sb.cap[which(bat$agg.sb.std > 6)]
bat$agg.sb.cap[which(bat$agg.sb.std > 7)]
bat$agg.sb.cap[which(bat$agg.sb.std > 8)]
bat$agg.sb.cap <- bat$agg.sb.std
bat$agg.sb.cap[which(bat$agg.sb.std > 8)] <- 8
bat$talent.index <- bat$agg.runs.std + bat$agg.hr.std + bat$agg.rbi.std + bat$agg.sb.cap + bat$agg.w.obp.std
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std),
std.hr=c(rep(NA, pit.length), bat$agg.hr.std),
std.rbi=c(rep(NA, pit.length), bat$agg.rbi.std),
std.sb=c(rep(NA, pit.length), bat$agg.sb.std),
std.obp=c(rep(NA, pit.length), bat$agg.obp.std),
std.w.obp=c(rep(NA, pit.length), bat$agg.w.obp.std),
w=c(pit$agg.w, rep(NA, bat.length)),
sv=c(pit$agg.sv, rep(NA, bat.length)),
k=c(pit$agg.k, rep(NA, bat.length)),
era=c(pit$agg.era, rep(NA, bat.length)),
whip=c(pit$agg.whip, rep(NA, bat.length)),
r=c(rep(NA, pit.length), bat$agg.runs),
hr=c(rep(NA, pit.length), bat$agg.hr),
rbi=c(rep(NA, pit.length), bat$agg.rbi),
sb=c(rep(NA, pit.length), bat$agg.sb),
obp=c(rep(NA, pit.length), bat$agg.obp),
w.obp=c(rep(NA, pit.length), bat$agg.w.obp)
)
df <- full_join(df.id, combined)
df[1:25, 1:5]
df<-arrange(df, desc(perf.index))
df[1:25, 1:5]
write.table(df, file='projections.csv', sep = ',')
df[which(df$position=='SP')]
df[which(df$position=='SP'),]
df[which(df$position=='RP'),]
head(combined)
arrange(combined, desc(name))
data<-arrange(combined, desc(name))
names<-arrange(df.id, desc(name))
write.table(data, file='data.csv', sep=',')
write.table(names, file='data.csv', sep=',')
df %>%
filter(position == 'RP' | 'SP')
df %>%
filter(position == 'RP' | position == 'SP')
batters <- df %>%
filter(position != 'RP' | position!= 'SP')
write.table(pitchers, file='pitchers.csv', sep=',')
pitchers <- df %>%
filter(position == 'RP' | position == 'SP')
write.table(pitchers, file='pitchers.csv', sep=',')
batters <- df %>%
filter(position != 'RP' | position!= 'SP')
write.table(batters, file='batters.csv', sep=',')
write.table(names, file='names.csv', sep=',')
data<-arrange(combined, desc(name))
names<-arrange(df.id, desc(name))
write.table(data, file='data.csv', sep=',')
write.table(names, file='names.csv', sep=',')
bat$talent.index <- bat$agg.runs.std + bat$agg.hr.std + bat$agg.rbi.std + bat$agg.sb.cap + bat$agg.w.obp.std
pit$agg.w.std <- scale(pit$agg.w)
pit$agg.sv.std <- scale(pit$agg.sv)*.34
pit$agg.k.std <- scale(pit$agg.k)
pit$agg.era.std <- scale(pit$agg.era)*-1
pit$agg.whip.std <- scale(pit$agg.whip)*-1
pit$agg.w.era.std <- scale(pit$agg.era/pit$ip.weight)*-1
pit$agg.w.whip.std <- scale(pit$agg.whip/pit$ip.weight)*-1
pit$talent.index <- pit$agg.w.std + pit$agg.sv.std + pit$agg.k.std + pit$agg.w.era.std + pit$agg.w.whip.std
pit.length <- length(pit$fans_Name)
bat.length <- length(bat$fans_Name)
combined <- data.frame(name=c(as.character(pit$fans_Name), as.character(bat$fans_Name)),
perf.index=c(pit$talent.index, bat$talent.index),
std.w=c(pit$agg.w.std, rep(NA, bat.length)),
std.sv=c(pit$agg.sv.std, rep(NA, bat.length)),
std.k=c(pit$agg.k.std, rep(NA, bat.length)),
std.era=c(pit$agg.era.std, rep(NA, bat.length)),
std.whip=c(pit$agg.whip.std, rep(NA, bat.length)),
std.r=c(rep(NA, pit.length), bat$agg.runs.std),
std.hr=c(rep(NA, pit.length), bat$agg.hr.std),
std.rbi=c(rep(NA, pit.length), bat$agg.rbi.std),
std.sb=c(rep(NA, pit.length), bat$agg.sb.std),
std.obp=c(rep(NA, pit.length), bat$agg.obp.std),
std.w.obp=c(rep(NA, pit.length), bat$agg.w.obp.std),
w=c(pit$agg.w, rep(NA, bat.length)),
sv=c(pit$agg.sv, rep(NA, bat.length)),
k=c(pit$agg.k, rep(NA, bat.length)),
era=c(pit$agg.era, rep(NA, bat.length)),
whip=c(pit$agg.whip, rep(NA, bat.length)),
r=c(rep(NA, pit.length), bat$agg.runs),
hr=c(rep(NA, pit.length), bat$agg.hr),
rbi=c(rep(NA, pit.length), bat$agg.rbi),
sb=c(rep(NA, pit.length), bat$agg.sb),
obp=c(rep(NA, pit.length), bat$agg.obp),
w.obp=c(rep(NA, pit.length), bat$agg.w.obp)
)
df <- full_join(df.id, combined)
df<-arrange(df, desc(perf.index))
write.table(df, file='projections.csv', sep = ',')
